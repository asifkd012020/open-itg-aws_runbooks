<img src="https://a0.awsstatic.com/libra-css/images/logos/aws_logo_smile_1200x630.png" alt="AWS" width="250"/>

# AWS MWAA (Managed Workflows for Apache Airflow) - Security Playbook <!-- omit in toc -->
## Capgroup Cybersecurity Control Alignment <!-- omit in toc -->


**Generated By:**  
[Philip Phan (PHLP)](https://cgweb3/profile/PHLP)
<br>
Platform Design Services

[Name (Initials)](https://cgweb3/profile/Initials)
<br>
Security Engineering

**Last Update:** *08/17/2021*

## Table of Contents <!-- omit in toc -->
- [Overview](#overview)
- [Cloud Security Requirements](#cloud-security-requirements)
  - [1. MWAA Utilizes VPC Endpoints to Prevent Public Access](#1-mwaa-utilizes-vpc-endpoints-to-prevent-public-access)
  - [2. MWAA Webserver Access is set to Private](#2-mwaa-webserver-access-is-set-to-private)
  - [3. MWAA data is encrypted at rest using CG CMK](#3-mwaa-data-is-encrypted-at-rest-using-cg-cmk)
  - [4. MWAA connections are Encrypted in transit using TLS 1.2](#4-mwaa-connections-are-encrypted-in-transit-using-tls-12)
  - [5. Configure MWAA execution roles to assume enforce least priviledge](#5-configure-mwaa-execution-roles-to-assume-enforce-least-priviledge)
  - [6. CloudTrail logging enabled for MWAA](#6-cloudtrail-logging-enabled-for-mwaa)
- [Other Operational Expectations](#other-operational-expectations)
  - [1. MWAA Resources are tagged according to CG standard MWAA](#1-mwaa-resources-are-tagged-according-to-cg-standard-mwaa)
- [Endnotes](#endnotes)
- [Capital Group Glossary](#capital-group-glossary)
<br><br>

## Overview
Amazon Managed Workflows for Apache Airflow (Amazon MWAA) is a managed orchestration service for Apache Airflow. 
Airflow is an open source tool for programatically authoring, scheduling, and monitoring workflows.  With MWAA you can use Airflow & Python to create workflows without having to managed underlying infrastructure. 
<br>
<img src="/docs/img/mwaa/mwaa_overview.png" width="800"><br>
<br>

## Cloud Security Requirements
<img src="/docs/img/Prevent.png" width="50">


### 1. MWAA Utilizes VPC Endpoints to Prevent Public Access
MWAA currently supports VPC Interface Endpoints, and as such allows the service to meet CG's stringent Public Access control requirements.
<br>

**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|[CS0012300](https://capitalgroup.service-now.com/cg_grc?sys_id=80df48c01bac20506a50beef034bcb47&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Cloud products and services must be deployed on private subnets and public access must be disabled for these services.|

**Why?**<br>
MWAA is a service that allows for the storage and processing of data from multiple services such as S3, SQS, and ECR. Due to the possibility of sensitive data being stored and processed while using this service, we need to make sure that this traffic is not transmitted directly over the Public Internet. 
<br>

**How?**<br>
https://docs.aws.amazon.com/mwaa/latest/userguide/vpc-vpe-create-access.html#vpc-vpe-create-view-endpoints-examples
To establish a private connection between your virtual private cloud (VPC), MWAA and other integrated services you should create VPC private endpoints. You can use these connections to call the services from your VPC without sending traffic over the Internet. The endpoint provides secure connectivity to the APIs without requiring an Internet gateway (IGW), NAT instance, or virtual private network (VPN) connection.

Interface VPC endpoints are powered by AWS PrivateLink, a feature that enables private communication between AWS services using private IP addresses. To use AWS PrivateLink, create an interface VPC endpoint for supported services in your VPC using the Amazon VPC console, API, or CLI. Doing this creates an elastic network interface in your subnet with a private IP address that serves requests. You can also access a VPC endpoint from on-premises environments or from other VPCs using AWS VPN, AWS Direct Connect, or VPC peering. Below are the steps to implement Interface VPC Endpoints for requires for MWAA: 

***Pre-requisites for Private MWAA*** <br>
Before deploying a private MWAA , you'll need to create all of the required VPC endpoints. You can either deploy them manually or use the CloudFormation template provided below. <br>

**Creation of VPC Endpoints via console(manual)**
1. Follow the instructions on the AWS Documentation below to create all the required VPC Endpoints required for a private MWAA
  - https://docs.aws.amazon.com/mwaa/latest/userguide/vpc-vpe-create-access.html#vpc-vpe-create-view-endpoints-attach-all
<br><br>

**Creation of VPC Endpoints via Cloud Formation**
1. Here's a CloudFormation template you can use to create all the required VPC endpoints & security group.  You will have to select your VPC and subnets during the stack deployment.  If you already have existing VPC endpoints for the services defined in the template, feel free to remove duplicates. 
<br>

```yaml <br>
AWSTemplateFormatVersion: "2010-09-09"

Parameters:
   VPC:
     Description: The VPC ID
     Type: String
     Default: "vpc-09fb3082379020967"

   SubnetIDList:
     Description: The IP range (CIDR notation) for this VPC
     Type: List<AWS::EC2::Subnet::Id>
     Default: "subnet-06fb0261137cd23c2, subnet-0f1e437e66b4c0445, subnet-0e5aa37a04c50bb0e, subnet-012b4723e96663325"
     
Resources:
   SecurityGroup:
     Type: AWS::EC2::SecurityGroup
     Properties:
       VpcId: !Ref VPC
       GroupDescription: Security Group for Amazon MWAA Environments to access VPC endpoints
       GroupName: !Sub "${AWS::StackName}-mwaa-vpc-endpoints"
   
   SecurityGroupIngress:
     Type: AWS::EC2::SecurityGroupIngress
     Properties:
       GroupId: !Ref SecurityGroup
       IpProtocol: "-1"
       SourceSecurityGroupId: !Ref SecurityGroup
   
   SqsVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.sqs"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup
     
   CloudWatchLogsVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.logs"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup
     
   CloudWatchMonitoringVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.monitoring"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup
     
   KmsVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.kms"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup
     
   EcrApiVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.ecr.api"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup
     
   EcrDkrVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.ecr.dkr"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup

   AirflowApiVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.airflow.api"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup  
        
   AirflowEnvVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.airflow.env"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup   
                                         
   AirflowOpsVpcEndoint:
     Type: AWS::EC2::VPCEndpoint
     Properties:
       ServiceName: !Sub "com.amazonaws.${AWS::Region}.airflow.ops"
       VpcEndpointType: Interface
       VpcId: !Ref VPC
       PrivateDnsEnabled: true
       SubnetIds: !Ref SubnetIDList
       SecurityGroupIds:
        - !Ref SecurityGroup

Outputs:
   MwaaSecurityGroupId:
     Description: Associates the Security Group to the environment to allow access to the VPC endpoints 
     Value: !Ref SecurityGroup  
```
<br>


### 2. MWAA Webserver Access is set to Private
MWAA environment supports publically accessable webserver access from the public internet, this option can be turned off and as such allows the service to meet CG's stringent Public Access Control Requirements. 
<br>

**Capital Group Controls:** 
<br>
|Control Statement|Description|
|------|----------------------|
|[CS0012300](https://capitalgroup.service-now.com/cg_grc?sys_id=80df48c01bac20506a50beef034bcb47&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Cloud products and services must be deployed on private subnets and public access must be disabled for these services.|

**Why?**<br>
As mentioned previously, CG has stringent public accessibility standards when it comes to deploying services in the cloud and MWAA is no different. When you launch an MWAA environment, you can turn on or off public accessibility for that environment, and turning off public accessibility allows the Airflow environment to meet the CG public access controls.

**How?**<br>

**Deploying a private MWAA environment with AWS Console** <br>
After deploying the private endpoints and security group to allow access to the endpoints, you can proceed with provisioning of a private MWAA. 

Provisioning Steps: 
1. In the Networking Section 
2. Select your private VPCs and Subnets to deploy MWAA in. 
3. Select the private network setting
4. Select the security group created as part of the Cloud Formation Template to allow access to your VPC Endpoints 

<br>
<img src="/docs/img/mwaa/mwaa_private_network.png" width="800"><br>

**Deploying a private MWAA environment with CloudFormation with Private Access Enabled** <br>
```yaml 
Resources:
  AirflowEnvironment: 
    Type: "AWS::MWAA::Environment"
    Properties: 
      WebserverAccessMode: "PRIVATE_ONLY"
```

### 3. MWAA data is encrypted at rest using CG CMK

**Why?**<br>
CG's Cloud Security standard require that we ensure that AWS Services that hold sensitive, critical or any other data are encrypted to fulfill compliance requirements for data-at-rest encryption. When creating a MWAA environment, you can specify a customer managed key for encryption.  

**How?**<br>
Users will be store files(DAGs) in Amazon S3, reference the s3 runbook to ensure compliance with CG Cloud Security Requirements [S3 Controls](https://github.com/open-itg/aws_runbooks/blob/CNTEN-3624-MWAA/s3/RUNBOOK.md) <br>

Logs will be stored in CloudWatch Logs, reference the Cloudwatch runbook to ensure compliance with CG Cloud Security Requirements [CloudWatch Controls](https://github.com/open-itg/aws_runbooks/tree/master/cloudwatch) <br>


[AWS Docs regarding MWAA Encryption](https://docs.aws.amazon.com/mwaa/latest/userguide/encryption-at-rest.html) <br>
CMK Requirement -  MWAA requires you use the same KMS encryption key used for S3 bucket to encrypt the MWAA environment.  CG's default S3 KMS Key Policy only allows the key to be used to encrypt s3 objects, so you will have to update the s3 kms key policy to allow encryption of the MWAA Environment.

```
{
    "Version": "2012-10-17",
    "Id": "key-default-s3",
    "Statement": [
        {
            "Sid": "Enable IAM User Permissions",
            "Effect": "Allow",
            "Principal": {
                "AWS": "arn:aws:iam::707172424705:root"
            },
            "Action": "kms:*",
            "Resource": "*"
        },
        {
            "Sid": "Allow access for Key Administrators",
            "Effect": "Allow",
            "Principal": {
                "AWS": [
                    "arn:aws:iam::707172424705:role/EncryptionKeyMgmtAdmin",
                    "arn:aws:iam::707172424705:role/SysAdmin"
                ]
            },
            "Action": [
                "kms:Create*",
                "kms:Describe*",
                "kms:Enable*",
                "kms:List*",
                "kms:Put*",
                "kms:Update*",
                "kms:Revoke*",
                "kms:Disable*",
                "kms:Get*",
                "kms:Delete*",
                "kms:ImportKeyMaterial",
                "kms:TagResource",
                "kms:UntagResource",
                "kms:ScheduleKeyDeletion",
                "kms:CancelKeyDeletion"
            ],
            "Resource": "*"
        },
        {
            "Sid": "Allow use of the key",
            "Effect": "Allow",
            "Principal": {
                "AWS": "*"
            },
            "Action": [
                "kms:Encrypt",
                "kms:Decrypt",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey*",
                "kms:DescribeKey"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "kms:ViaService": [
                        "s3.us-west-2.amazonaws.com",
                        "airflow.us-west-2.amazonaws.com",
                    ],
                    "aws:PrincipalOrgID": "o-1eax4cor5e"
                }
            }
        },
        {
            "Sid": "Allow attachment of persistent resources",
            "Effect": "Allow",
            "Principal": {
                "AWS": "*"
            },
            "Action": [
                "kms:CreateGrant",
                "kms:ListGrants",
                "kms:RevokeGrant"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "kms:CallerAccount": "707172424705",
                    "kms:ViaService": [
                        "s3.us-west-2.amazonaws.com",
                        "airflow.us-west-2.amazonaws.com",
                    ]
                },
                "Bool": {
                    "kms:GrantIsForAWSResource": "true"
                }
            }
        },
        {
            "Sid": "Allow all principals within the account to describe and list key information",
            "Effect": "Allow",
            "Principal": {
                "AWS": "*"
            },
            "Action": [
                "kms:Describe*",
                "kms:List*"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "aws:PrincipalOrgID": "o-1eax4cor5e"
                }
            }
        },
        {
            "Sid": "LogSupport",
            "Effect": "Allow",
            "Principal": {
                "Service": "logs.us-west-2.amazonaws.com"
            },
            "Action": [
                "kms:Encrypt*",
                "kms:Decrypt*",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey*",
                "kms:Describe*"
            ],
            "Resource": "*"
        }
    ]
}
```

During provisioning of MWAA via the AWS Management Console: 
1. Scroll down to Encryption Section
2. Check Box "Customize encryption settings(advanced)" 
3. Select your CMK ARN for S3
<br>
<img src="/docs/img/mwaa/mwaa_cmk.png" width="800"><br>
<br> <br>


### 4. MWAA connections are Encrypted in transit using TLS 1.2

**Capital Group Controls:**<br>

|Control Statement|Description|
|------|----------------------|
|Control ID |Control Description|

**Why?**<br>
At CG we require that all data and services in the cloud are encrypted both at rest and in-transit and as such, the best mechanism to securly provide in-transit encryption is TLS 1.2.

**How?**<br>
https://docs.aws.amazon.com/mwaa/latest/userguide/encryption-in-transit.html 
Transport Layer Security (TLS) encrypts the Amazon MWAA objects in transit between Fargate containers and Amazon S3. For in-depth information about Amazon S3 encryption, see Protecting Data Using Encryption. You can specify a CG CMK for the encryption artifacts used for in-transit encryption. 

### 5. Configure MWAA execution roles to assume enforce least priviledge

**Capital Group Controls:**<br>

|Control Statement|Description|
|------|----------------------|
|Control ID |Control Description|

**Why?**<br>
When you create custom policies, grant only the permissions required to perform at a DAG task level. Start with a minimum set of permissions and grant additional permissions as necessary. Doing so is more secure than starting with permissions that are too lenient and then trying to tighten them later.  

To the extent that it's practical, define the conditions under which your identity-based policies allow access to a resource. For example, you can write conditions to specify a range of allowable IP addresses that a request must come from.

**How?**<br>
MWAA is fully integrated with AWS IAM for authentication and access control.  You can leverage MWAA execution role with iam permissions policy that grants MWAA permission to invoke other AWS Resources on your behalf.  Craft your IAM Policies to assign exact IAM permissions that you need. 

For example, in order to access your s3 bucket and publish logs to cloudwatch logs, you'll need to add the following IAM Permissions to your MWAA execution role. 
```json
        {
            "Effect": "Allow",
            "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*"
            ],
            "Resource": [
                "arn:aws:s3:::pds-mwaa-test1",
                "arn:aws:s3:::pds-mwaa-test1/*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "logs:CreateLogStream",
                "logs:CreateLogGroup",
                "logs:PutLogEvents",
                "logs:GetLogEvents",
                "logs:GetLogRecord",
                "logs:GetLogGroupFields",
                "logs:GetQueryResults"
            ],
            "Resource": [
                "arn:aws:logs:us-west-2:707172424705:log-group:airflow-pds-mwaa-test2-*"
            ]
        }
```

AWS has taken this one step further, you can now leverage Airflow PythonOperators that can tightly couple task access requirements to separate IAM roles , which takes advantages of AWS STS to assume the associated role.  Use AWS Identity and Access Management (IAM) policies to assign permissions that determine what AWS Resource your tasks is allowed to access.

For example, you can have two different iam roles for two different airflow task. 
1) 1 Airflow Task with attached IAM Role to only PutObject in S3 Bucket TestA
2) 1 Airflow Task with attached IAM Role to only DeleteObject from S3 Bucket TestB

AWS Docs Reference 
[1] https://docs.aws.amazon.com/mwaa/latest/userguide/mwaa-create-role.html#mwaa-create-role-how
[2] https://aws.amazon.com/blogs/big-data/bolster-security-with-role-based-access-control-in-amazon-mwaa/ 
[3] https://github.com/aws-samples/mwaa-rbac-task/tree/main/dags/rbac_dag 

Steps:
1. Create IAM Role & Policy to Put Object in only S3 Bucket 
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "VisualEditor0",
            "Effect": "Allow",
            "Action": [
                "s3:PutObject",
                "s3:DeleteObject"
            ],
            "Resource": "arn:aws:s3:::<AWS_ACCOUNT_ID>-<AWS_REGION>-mwaa-processed/*"
        }
    ]
}
```

1. Update trust relationship of the IAM Role to allow MWAA execution role to assume
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": [
          "arn:aws:iam::<AWS_ACCOUNT_ID>:assumed-role/<MWAA-EXECUTION_ROLE>/AmazonMWAA-airflow"
        ],
        "Service": "s3.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}
``` 
3. Sample definition of DAG that uses an IAM Role to run
```python
dag = DAG(
    dag_id="rbac_task",
    description="Sample DAG with fine grain access for tasks",
    default_args=dag_default_args,
    start_date=days_ago(0),
    schedule_interval="@once",
    catchup=False,
)

process_task = RBACPythonOperator(
    task_id="process_task",
    python_callable=task_process,
    provide_context=True,
    op_kwargs={"bucket": cf.PROCESSED_S3_BUCKET},
    task_iam_role_arn=cf.PROCESSED_IAM_ROLE,
    dag=dag,
)
```

### 6. CloudTrail logging enabled for MWAA

**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|N/A| No security control currently defined.|

**Why?**<br>

Using the information collected by Cloudtrail, you can determine the request that was made to MWAA , The IP address from which the request was made, who made the request. when the request was made and additional details that will help protect your database instances. 

**How?**<br>

**Log Amazon MWAA API Calls with AWS CloudTrail**

MWAA is integrated with AWS CloudTrail, a service that provides a record of actions taken by a user, role, or an AWS service in Amazon MWAA\. CloudTrail captures all API calls for Amazon MWAA as events, including calls from the Amazon MWAA console and from code calls to the Amazon MWAA APIs\. If you create a trail, you can enable continuous delivery of CloudTrail events to an Amazon S3 bucket, including events for Amazon MWAA\. If you don't configure a trail, you can still view the most recent events in the CloudTrail console in **Event history**\. Using the information collected by CloudTrail, you can determine the request that was made to Amazon MWAA, the IP address from which the request was made, who made the request, when it was made, and additional details\. 

To learn more about CloudTrail, see the [CloudTrail Runbook](https://github.com/open-itg/aws_runbooks/blob/master/cloudtrail/Runbook.md).


## Other Operational Expectations
<img src="/docs/img/Operations.png" width="50">

### 1. MWAA Resources are tagged according to CG standard MWAA
**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|N/A| No security control currently defined.|

**What, Why & How?**

Tagging resources in the cloud is an easy way for teams to provide information related to who owns the resource, what the resource is used for, as well as other important information related to the deployment lifecycle of the resource. CG has mandated that all cloud resources are to be tagged with certain important for cross-team use. Although most of the mandatory tags will be added through automation, one should still check to make sure that all newly deployed recources have the appropriate tags attached. please see the documentation below for the latest tagging standards.

[CG Cloud Tagging Strategy](https://confluence.capgroup.com/display/HCEA/Resource+Tagging+standards)
<br><br>

## Endnotes
**Resources**<br>
1. https://aws.amazon.com/managed-workflows-for-apache-airflow/
2. https://docs.aws.amazon.com/mwaa/latest/userguide/encryption-at-rest.html
3. https://docs.aws.amazon.com/mwaa/latest/userguide/mwaa-create-role.html#mwaa-create-role-how
4. https://aws.amazon.com/blogs/big-data/bolster-security-with-role-based-access-control-in-amazon-mwaa/ 
5. https://github.com/aws-samples/mwaa-rbac-task/tree/main/dags/rbac_dag 
6. https://docs.aws.amazon.com/mwaa/latest/userguide/monitoring-cloudtrail.html

<br><br>

## Capital Group Glossary 
**Data** - Digital pieces of information stored or transmitted for use with an information system from which understandable information is derived. Items that could be considered to be data are: Source code, meta-data, build artifacts, information input and output.  
 
**Information System** - An organized assembly of resources and procedures for the collection, processing, maintenance, use, sharing, dissemination, or disposition of information. All systems, platforms, compute instances including and not limited to physical and virtual client endpoints, physical and virtual servers, software containers, databases, Internet of Things (IoT) devices, network devices, applications (internal and external), Serverless computing instances (i.e. AWS Lambda), vendor provided appliances, and third-party platforms, connected to the Capital Group network or used by Capital Group users or customers.

**Log** - a record of the events occurring within information systems and networks. Logs are composed of log entries; each entry contains information related to a specific event that has occurred within a system or network.

**Information** - communication or representation of knowledge such as facts, data, or opinions in any medium or form, including textual, numerical, graphic, cartographic, narrative, or audiovisual. 

**Cloud computing** - A model for enabling ubiquitous, convenient, on-demand network access to a shared pool of configurable computing resources (e.g., networks, servers, storage, applications, and services) that can be rapidly provisioned and released with minimal management effort or service provider interaction.

**Vulnerability**  - Weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source. Note: The term weakness is synonymous for deficiency. Weakness may result in security and/or privacy risks.