<img src="https://a0.awsstatic.com/libra-css/images/logos/aws_logo_smile_1200x630.png" alt="AWS" width="250"/>

# AWS DynamoDB - Security Runbook <!-- omit in toc -->
## Capgroup Cybersecurity Control Alignment <!-- omit in toc -->

**Generated By:**  
[Josh Linus (JHZL)](https://cgweb3/profile/JHZL)  
Security Engineering

**Last Update:** *07/21/2021*

## Table of Contents <!-- omit in toc -->
- [Overview](#overview)
- [Cloud Security Requirements](#cloud-security-requirements)
  - [1. Enforce least privilege for all DynamoDB users and roles](#make-sure-this-is-correct-link)
  - [2. Tables are encrypted using CG CMK](#make-sure-this-is-correct-link)
  - [3. Data in Transit is encrypted using TLS 1.2](#make-sure-this-is-correct-link)
  - [4. DynamoDB Utilizes VPC Endpoints to Prevent Public Access](#make-sure-this-is-correct-link)
  - [5. Utilize DynamoDB streams to support data-plane logging](#make-sure-this-is-correct-link)
  - [6. Log DynamoDB Operations with AWS CloudTrail](#make-sure-this-is-correct-link)
  - [7. Create CloudWatch Alarms to monitor DynamoDB](#make-sure-this-is-correct-link)
- [Operational Best Practices](#cloud-security-requirements)
    - [1. Tagging](#make-sure-this-is-correct-link)
    - [2. DynamoDB Continuous Backups](#make-sure-this-is-correct-link)
    - [3. DynamoDB Backup / Restore setup](#make-sure-this-is-correct-link)
    - [4. Unused Tables should be removed](#make-sure-this-is-correct-link)     <-- Cost Savings..
- [Endnotes](#endnotes)
- [Capital Group Glossory](#Capital-Group-Glossory) 

## Overview
Amazon DynamoDB is a hosted NoSQL database offered by Amazon Web Services. It supports key-value and document database and delivers performance at any scale. It's a fully managed, multi-region, multi-active, durable database with built-in security, backup and restore, and in-memory caching for internet-scale applications.

DynamoDB is particularly useful for cases such as:
 - Applications with large amounts of data and strict latency requirements
 - Serverless applications using AWS Lambda
 - Data sets with simple, known access patterns 

**Features & Benefits**
 - Performance at scale
 - No servers to manage
 - Enterprise ready

## Preventative Controls
<img src="/docs/img/Prevent.png" width="50">  

### 1. Enforce least privilege for all DynamoDB users and roles
<!-- This Requirement is good, just needs new controls-->
**Why?**   
`This Section will be updated soon.`

**How?**   
`This Section will be updated soon.`


<!-- I think we need to split this into At Rest, and in-transit encryption as controls can apply better. -->
### 2. Tables are encrypted using CG CMK
**Why?**   
`This Section will be updated soon.`

**How?**   
`This Section will be updated soon.`

<!-- Maybe add this as a note in an appropriate section, maybe operational best practice? -->
>**NOTE:**   
Due to limitations in key management, Amazon DynamoDB Accelerator (DAX) is not an approved feature within Capital Group, and is therefore not allowed to be used in any environment.
<!-- keep the above warning -->


### 3. Data in Transit is encrypted using TLS 1.2
<!-- Need to CGify :), I had a generic template I used for most of these ones.-->
**Why?**   
`This Section will be updated soon.`

**How?**    
`This Section will be updated soon.`

### 4. DynamoDB Utilizes VPC Endpoints to Prevent Public Access

**Why?**    
A VPC endpoint for DynamoDB enables Amazon EC2 instances in your VPC to use their private IP addresses to access DynamoDB with no exposure to the public internet. Your EC2 instances do not require public IP addresses, and you don't need an internet gateway, a NAT device, or a virtual private gateway in your VPC. You use endpoint policies to control access to DynamoDB. Traffic between your VPC and the AWS service does not leave the Amazon network.

When you create a VPC endpoint for DynamoDB, any requests to a DynamoDB endpoint within the Region (for example, dynamodb.us-west-2.amazonaws.com) are routed to a private DynamoDB endpoint within the Amazon network. You don't need to modify your applications running on EC2 instances in your VPC. The endpoint name remains the same, but the route to DynamoDB stays entirely within the Amazon network, and does not access the public internet.

**How?**  
`This Section will be updated soon.`


### 5. Utilize DynamoDB streams to support data-plane logging

**Why?**   
`This Section will be updated soon.`

**How?**   
`This Section will be updated soon.`

<!-- This will be pretty generic for all runbooks as CloudTrail RB should handle this.. -->
### 6. CloudTrail logging enabled for DynamoDB  

**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|Control Definition Needed|Control Definition Description Needed|

**What, Why & How?**  
`This Section will be updated soon.`

<br><br>
### 7. Create CloudWatch Alarms to monitor DynamoDB

**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|Control Definition Needed|Control Definition Description Needed|

**What, Why & How?**  
`This Section will be updated soon.`

<br><br>  

## Operational Best Practices
### 1. Tagging
**Why?**

**How?**

### 2. DynamoDB Continuous Backups
**Why?**

**How?**

### 3. DynamoDB Backup / Restore setup
**Why?**

**How?**

### 4. Unused Tables should be removed
**Why?**

**How?**

## Endnotes


## Capital Group Control Statements 
1. All Data-at-rest must be encrypted and use a CG BYOK encryption key.
2. All Data-in-transit must be encrypted using certificates using CG Certificate Authority.
3. Keys storied in a Key Management System (KMS) should be created by Capital Group's hardware security module (HSM) and are a minimum of AES-256.
4. AWS services should have logging enabled and those logs delivered to CloudTrail or Cloud Watch.
5. AWS IAM User accounts are only to be created for use by services or products that do not support IAM Roles. Services are not allowed to create local accounts for human use within the service. All human user authentication will take place within CGâ€™s Identity Provider.
6. Any AWS service used by CG should not be directly available to the Internet and the default route is always the CG gateway.
7. Use of AWS IAM accounts are restricted to CG networks.
8. AWS IAM User secrets, including passwords and secret access keys, are to be rotated every 90 days. Accounts created locally within any service must also have their secrets rotated every 90 days.
9. Encryption keys are rotated annually.
10. Administrative access to AWS resources will have MFA enabled

## Glossary
**Data** - Digital pieces of information stored or transmitted for use with an information system from which understandable information is derived. Items considered to be data are: Source code, meta-data, build artifacts, information input and output.  
 
**Information System** - An organized assembly of resources and procedures for the collection, processing, maintenance, use, sharing, dissemination, or disposition of information. All systems, platforms, compute instances including and not limited to physical and virtual client endpoints, physical and virtual servers, software containers, databases, Internet of Things (IoT) devices, network devices, applications (internal and external), Serverless computing instances (i.e. AWS Lambda), vendor provided appliances, and third-party platforms, connected to the Capital Group network or used by Capital Group users or customers.
 
**Log** - a record of the events occurring within information systems and networks. Logs are composed of log entries; each entry contains information related to a specific event that has occurred within a system or network.
 
**Information** - communication or representation of knowledge such as facts, data, or opinions in any medium or form, including textual, numerical, graphic, cartographic, narrative, or audiovisual. 
 
**Cloud Computing** - A model for enabling ubiquitous, convenient, on-demand network access to a shared pool of configurable computing resources (e.g., networks, servers, storage, applications, and services) that can be rapidly provisioned and released with minimal management effort or service provider interaction.
 
**Vulnerability**  - Weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source. Note: The term weakness is synonymous for deficiency. Weakness may result in security and/or privacy risks.
