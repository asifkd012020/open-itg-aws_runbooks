{
    "servicerequirement_name": [
        "AWS::ECS::*"
    ],
    "phase": "discovery",
    "mapping": [
        {
            "requirement_requirement_name": "ECS - Disable Public IP Access",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_DisablePubAPIAccess",
            "tags":[],
            "severity": [
                {
                    "Prod": "critical",
                    "SNP": "critical",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": [
                {
                    "provider": "dome9",
                    "implementation": [
                        "https://bitbucket.capgroup.com/projects/CLSEC/repos/dome9/browse/AWS_Rulesets/CG-AWS-SO-NetworkControl.json#63",
                        "https://bitbucket.capgroup.com/projects/CLSEC/repos/dome9/browse/AWS_Rulesets/CG-AWS-SO-NetworkControl.json#73"
                    ],
                    "type": "detect"
                },
                {
                    "provider": "aws config",
                    "implementation": [
                        "https://confluence.capgroup.com/display/HCEA/Operational+Best+Practices+-+Detect+Publicly+Accessible+Resources"
                    ],
                    "type": "detect"
                },
                {
                    "provider": "panoptes",
                    "implementation": [
                        "https://github.com/open-itg/panoptes/blob/master/panoptes-rules/ecs.py#L5"
                    ],
                    "type": "prevent"
                }
            ]
        },
        {
            "requirement_name": "ECS - Resource Tagging",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_Tagging",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - Logdriver Forwarding",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_AWSLogDriver",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - Cloud Watch Logging",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_CloudWatchlLogging",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - Cloud Trail Logging",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_CloudTraillLogging",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - Security Group scoped for Cluster-only Communications",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_ClusterCommScope",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - Secrets Managed by CG BYOK",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_SecretsBYOK",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - EC2 Instances IAM Roles Defined",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_EC2_IAM",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - EC2 Instances Encrypted with CG KMS",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_EC2_KMS",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": [
                {
                    "provider": "dome9",
                    "implementation": [
                        "https://bitbucket.capgroup.com/projects/CLSEC/repos/dome9/browse/AWS_Rulesets/CG-AWS-SO-EncryptionAndKeyManagement.json#83"
                    ],
                    "type": "detect"
                }
            ]
        },
        {
            "requirement_name": "ECS - EC2 Instance resources tagged",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_EC2_Tag",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - Fargate Managed Docker Read-Only Filesystem",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_FGate_RO_FS",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        },
        {
            "requirement_name": "ECS - Fargate Managed with no Volume Mounts",
            "policy": "https://confluence.capgroup.com/display/HCEA/AWS+Services+Security+Checklist+for+CG+Deployments#AWSServicesSecurityChecklistforCGDeployments-ECS_No_VolumeMounts",
            "tags":[],
            "severity": [
                {
                    "Prod": "high",
                    "SNP": "high",
                    "NP": "medium"
                }
            ],
            "control_mapping": [],
            "implementations": []
        }
    ]
}
