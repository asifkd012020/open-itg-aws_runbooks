<img src="https://a0.awsstatic.com/libra-css/images/logos/aws_logo_smile_1200x630.png" alt="AWS" width="250"/>

# AWS EFS (Elastic File System) - Security Playbook <!-- omit in toc -->
## NIST Cybersecurity Framework Alignment <!-- omit in toc -->

**Generated By:**  
[Rob Goss (RMG)](https://cgweb3/profile/RMG)
<br>
Security Engineering

**Last Update:** *04/19/2021*

## Table of Contents <!-- omit in toc -->
- [Overview](#overview)
- [Preventative Controls](#Preventative-Controls)
  - [1. EFS Utilizes VPC Endpoints to Prevent Public Access](#1-EFS-Utilizes-VPC-Endpoints-to-Prevent-Public-Access)
  - [2. EFS Users and Roles defined following least privileged model](#2-EFS-Users-and-Roles-defined-following-least-privileged-model)
  - [3. EFS is Encrypted using CG Managed KMS Keys](#3-EFS-is-Encrypted-using-CG-Managed-KMS-Keys)
  - [4. EFS connections are protected with TLS 1.2](#4-EFS-connections-are-protected-with-TLS-1-2)
  - [5. EFS access points created following least privileged model](#5-EFS-access-points-created-following-least-privileged-model)
  - [6. EFS root access disabled by default](#6-EFS-root-access-disabled-by-default)
- [Detective Controls](#Detective-Controls)
  - [1. EFS Resources are tagged according to CG standards](#1-EBS-Resources-are-tagged-according-to-CG-standards)
  - [2. CloudTrail logging enabled and sent to Splunk](#2-CloudTrail-logging-enabled-and-sent-to-Splunk)
  - [3. CloudWatch logging enabled and sent to Splunk](#3-CloudWatch-logging-enabled-and-sent-to-Splunk)
- [Respond & Recover](#Respond/Recover)
- [Endnotes](#Endnotes)
- [Capital Group Glossory](#Capital-Group-Glossory) 


## Overview
AWS Secrets Manager helps you protect secrets needed to access your applications, services, and IT resources. The service enables you to easily rotate, manage, and retrieve database credentials, API keys, and other secrets throughout their lifecycle. Users and applications retrieve secrets with a call to Secrets Manager APIs, eliminating the need to hardcode sensitive information in plain text. Secrets Manager offers secret rotation with built-in integration for Amazon RDS, Amazon Redshift, and Amazon DocumentDB. Also, the service is extensible to other types of secrets, including API keys and OAuth tokens. In addition, Secrets Manager enables you to control access to secrets using fine-grained permissions and audit secret rotation centrally for resources in the AWS Cloud, third-party services, and on-premises.

<img src="/docs/img/secretsmanager/sec_arch.png" width="800"><br>

**Benefits of Secrets Manager:**
 - Rotate secrets safely
 - Manage access with fine-grained policies
 - Securely audit secrets centrally
 - Easily replicate secrets to multiple regions
 - Programmatic retrieval of secrets
 <br><br>

## Secrets will be generated, vaulted and managed securely
### Requester should not have knowledge of a secret

## Secrets manager will enforce the Enterprise Password Management requirements
http://projects/sites/RiskManagementIC/publiclibrary/Enterprise%20Password%20Management%20Statement%20of%20Direction.pdf

## Secrets will be encrypted at rest using CG KMS

## Access to secrets are allowed following the least privileged access model

## Secrets will be rotated if it has been exposed

## Only application secrets will be stored in Secrets Manager

## Disable cross account access to secrets 