<img src="https://a0.awsstatic.com/libra-css/images/logos/aws_logo_smile_1200x630.png" alt="AWS" width="250"/>

# Amazon QuickSight - Security Playbook <!-- omit in toc -->
## NIST Cybersecurity Framework Alignment <!-- omit in toc -->

**Generated By:**  
Rob Goss (RMG)  
*Security Engineering*

## Table of Contents <!-- omit in toc -->
- [Overview](#overview)
- [Preventative Controls](#Preventative-Controls)
  - [1. IAM Users and Roles Enforce Least Priviledge](#1.-IAM-Users-and-Roles-Enforce-Least-Priviledge)
  - [2. Enforce Multi-Factor Authentication (MFA)](#2.-Enforce-Multi-Factor-Authentication-(MFA))
  - [3. Private VPC Access for QuickSight](#3.-Private-VPC-Access-for-QuickSight)
  - [4. Encrypt data at rest](#4.-Encrypt-data-at-rest)
  - [5. Encrypt data in transit](#5.-Encrypt-data-in-transit)
- [Detective Controls](#Detective-Controls)
- [Respond & Recover](#Respond/Recover)
- [Endnotes](#Endnotes)
- [Capital Group Glossory](#Capital-Group-Glossory) 

## Overview
Amazon QuickSight is a cloud-scale business intelligence (BI) service that you can use to deliver easy-to-understand insights to the people who you work with, wherever they are. Amazon QuickSight connects to your data in the cloud and combines data from many different sources. In a single data dashboard, QuickSight can include AWS data, third-party data, big data, spreadsheet data, SaaS data, B2B data, and more. As a fully managed cloud-based service, Amazon QuickSight provides enterprise-grade security, global availability, and built-in redundancy. 

Amazon QuickSight enables you to manage your users and content using a comprehensive set of security features. These include role-based access control, Microsoft Active Directory integration, AWS CloudTrail auditing, single sign-on using AWS Identity and Access Management (IAM) and third-party solutions, private VPC subnets, and data backup. Amazon QuickSight security features, if implemented correctly will allow the service to meet Capital Groups current security standards and expectations for Cloud based services.

The following NIST Controls and Subcategories are not applicable to this service:  

The following Capital Group control statements are not applicable to this service: 

## Preventative Controls
<img src="/docs/img/Prevent.png" width="50">

### 1. IAM Users and Roles Enforce Least Priviledge
**NIST CSF:**
|NIST Subcategory Control|Description|
|-----------|------------------------|
|PR.AC-1|Identities and credentials are issued, managed, verified, revoked, and audited for authorized devices, users and processes|
|PR.AC-3|Remote Access is managed|
|PR.AC-4|Access permissions and authorizations are managed, incorporating the principles of least privilege and separation of duties|
|PR.AC-6|Identities are proofed and bound to credentials and asserted in interactions|
|PR.PT-3|The principle of least frunctionality is incorporated by configuring systems to rpovide only essential capabilities|

**Capital Group:**
|Control Statement|Description|
|------|----------------------|
|8|Local IAM secrets are rotated every 90 days, including accounts IaaS resources.

**Why?**
Different users/services will require different levels of access within the service. Having clearly defined policies and limiters will ensure that a user is not able to access and manage data in ways that they shouldn't be able to.

**How?**

### 2. Enforce Multi-Factor Authentication (MFA)
**NIST CSF:**
|NIST Subcategory Control|Description|
|-----------|------------------------|
|PR.AC-1|Identities and credentials are issued, managed, verified, revoked, and audited for authorized devices, users and processes|
|PR.AC-3|Remote Access is managed|
|PR.AC-6|Identities are proofed and bound to credentials and asserted in interactions|
|PR.AC-7|Users, devices, and other assets are authenticated (e.g., single-factor, multi-factor) commensurate with the risk of the transaction (e.g., individualsâ€™ security and privacy risks and other organizational risks)|

**Capital Group:**
|Control Statement|Description|
|------|----------------------|
|N/A|N/A|

**Why?**
Different users/services will require different levels of access within the service. Having clearly defined policies and limiters will ensure that a user is not able to access and manage data in ways that they shouldn't be able to.

**How?**

### 3. Private VPC Access for QuickSight

**NIST CSF:**
|NIST Subcategory Control|Description|
|-----------|------------------------|
|PR.PT-4|Communications and control networks are protected|
|PR.AC-5|Network integrity is protected (e.g., network segregation, network segmentation)|

**Capital Group:**
|Control Statement|Description|
|------|----------------------|
|6|Any AWS service used by CG should not be directly available to the Internet and the default route is always the CG gateway.|

**Why?**
When using Platform as a Service (PaaS) tools and services such as QuickSight, it may not be possible to setup the tool iteself inside of a private VPC.  Exposure to public networks should be avoided, or if unavoidable security best practices should be implemented for the specific service to limit service specific security issues. 

**How?**
Although QuickSight cannot be deployed inside a Private VPC, it is possible to limit public exposure of the data sources that QuickSight requires access to.  With the *Enterprise edition* it is possible for QuickSight to access data sources located in a private VPC using a VPC Endpoint and access to on-premesis data sources via Direct Connect.  

By creating a VPC connection in QuickSight, you're adding an elastic network interface in your VPC. This network interface allows QuickSight to exchange network traffic with a network instance within your VPC. You can provide all of the standard security controls for this network traffic, as you do with other traffic in your VPC. Route tables, network access control lists (ACLs), subnets, and security groups settings all apply to network traffic to and from QuickSight in the same way that they apply to traffic between other instances in your VPC.

<img src="https://media.amazonwebservices.com/blog/2017/qs_vpc_private_2.png" alt="Example Diagram" width="500"/>

When you register a VPC connection with QuickSight, you can securely connect to data that's available only in your VPC, for example:

- Data you can reach by IP address
- Data that isn't available on the public internet
- Private databases
- On-premises data
    

### 4. Encrypt data at rest

**NIST CSF:**
|NIST Subcategory Control|Description|
|-----------|------------------------|
|PR.DS-1|Data-at-rest is protected|

**Capital Group:**
|Control Statement|Description|
|------|----------------------|
|1|All Data-at-rest must be encrypted and use a CG BYOK encryption key.|
|2|Keys storied in a Key Management System (KMS) should be created by Capital Group's hardware security module (HSM) and are a minimum of AES-256.|

**Why?**
Data should be protected at-rest, in-transit between the customer and AWS, as well as in-transit between AWS Services using NIST-approved and CG-approved encryption mechanisms.

**How?**
Amazon QuickSight does not actually store data that is used in the reports, but instead the service stores metadata and data that you as a user upload into SPICE.  This data is not encrypted when using the *Standard edition*, with the *Enterprise edition* the data uploaded to SPICE has block-level encryption applied using AWS-managed keys.  Encryption of the data sources used for analysis is not handled by QuickSight as it is not storing any of this data, the encryption of these sources is handled by the source itself.

QuickSight Metadata contains the following:
- Amazon QuickSight user data, including Amazon QuickSight user names, email addresses, and passwords. Amazon QuickSight administrators can view user names and emails, but each user's password is completely private to each user.
- Minimal data necessary to coordinate user identification with your Microsoft Active Directory or identity federation implementation (Federated Single Sign-On (SSO) through Security Assertion Markup Language 2.0 (SAML 2.0)).
- Data source connection data
- Names of your uploaded files, data source names, and data set names.
- Statistics that Amazon QuickSight uses to populate machine learning (ML) insights

Due to the *Standard edition* of QuickSight not supporting encryption of the data at rest, coupled with the type of information being stored as metadata, the *Enterprise edition* of the service should be used allowing the service owner to meet the CG Encryption controls required.


### 5. Encrypt data in transit

**NIST CSF:**
|NIST Subcategory Control|Description|
|-----------|------------------------|
|PR.DS-2|Data-in-transit is protected|

**Capital Group:**
|Control Statement|Description|
|------|----------------------|
|1|All Data-in-transit must be encrypted using certificates using CG Certificate Authority.|

**Why?**
Data should be protected at-rest, in-transit between the customer and AWS, as well as in-transit between AWS Services using NIST-approved and CG-approved encryption mechanisms.

**How?**
Amazon QuickSight supports encryption for all data transfers. This includes transfers from the data source to SPICE, or from SPICE to the user interface. However, encryption isn't mandatory. For some databases, you can choose whether transfers from the data source are encrypted or not. Amazon QuickSight secures all encrypted transfers by using Secure Sockets Layer (SSL).

Whenever data is transmitted over the internet or public networks such as AWS, encryption of these connections must take place. All encrypted connections should utilize TLS 1.2 or above, as previous versions have know security flaws.

## Detective Controls
<img src="/docs/img/Detect.png" width="50">

### 1. Resources are tagged according to CG standards

### 2. CloudWatch logging enabled and sent to Splunk

## Respond/Recover
<img src="/docs/img/Monitor.png" width="50">

### 1. 

## Endnotes
**Resources**

## Capital Group Glossory 
**Data** - Digital pieces of information stored or transmitted for use with an information system from which understandable information is derived. Items that could be considered to be data are: Source code, meta-data, build artifacts, information input and output.  
 
**Information System** - An organized assembly of resources and procedures for the collection, processing, maintenance, use, sharing, dissemination, or disposition of information. All systems, platforms, compute instances including and not limited to physical and virtual client endpoints, physical and virtual servers, software containers, databases, Internet of Things (IoT) devices, network devices, applications (internal and external), Serverless computing instances (i.e. AWS Lambda), vendor provided appliances, and third-party platforms, connected to the Capital Group network or used by Capital Group users or customers.

**Log** - a record of the events occurring within information systems and networks. Logs are composed of log entries; each entry contains information related to a specific event that has occurred within a system or network.

**Information** - communication or representation of knowledge such as facts, data, or opinions in any medium or form, including textual, numerical, graphic, cartographic, narrative, or audiovisual. 

**Cloud computing** - A model for enabling ubiquitous, convenient, on-demand network access to a shared pool of configurable computing resources (e.g., networks, servers, storage, applications, and services) that can be rapidly provisioned and released with minimal management effort or service provider interaction.

**Vulnerability**  - Weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source. Note: The term weakness is synonymous for deficiency. Weakness may result in security and/or privacy risks.
