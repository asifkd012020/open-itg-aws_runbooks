<img src="https://a0.awsstatic.com/libra-css/images/logos/aws_logo_smile_1200x630.png" alt="AWS" width="250"/>

# AWS GuardDuty - Security Playbook <!-- omit in toc -->
## Capgroup Cybersecurity Control Alignment <!-- omit in toc -->

**Generated By:**  
[Rob Goss (RMG)](https://cgweb3/profile/RMG)
<br>
Security Engineering

**Last Update:** *05/20/2021*

## Table of Contents <!-- omit in toc -->
- [Overview](#overview)
- [Preventative Controls](#Preventative-Controls)
  - [1. GuardDuty Users and Roles defined following least privilege model](#1-GuardDuty-Users-and-Roles-defined-following-least-privilege-model)
  - [2. GuardDuty access limited to Security Teams](#2-GuardDuty-access-limited-to-Security-Teams)
  - [3. GuardDuty resources are Encrypted using CG Managed KMS Keys](#3-GuardDuty-reources-are-Encrypted-using-CG-Managed-KMS-Keys)
  - [4. GuardDuty connections are Encrypted in transitusing TLS 1.2](#4-GuardDuty-connections-are-Encrypted-in-transitusing-TLS-1-2)
  - [5. GuardDuty ](#)
- [Detective Controls](#Detective-Controls)
  - [1. EventBridge Resources are tagged according to CG standards](#1-EventBridge-Resources-are-tagged-according-to-CG-standards)
  - [2. CloudTrail logging enabled and sent to Splunk](#2-CloudTrail-logging-enabled-and-sent-to-Splunk)
  - [3. CloudWatch logging enabled and sent to Splunk](#3-CloudWatch-logging-enabled-and-sent-to-Splunk)
- [Respond & Recover](#Respond/Recover)
- [Endnotes](#Endnotes)
- [Capital Group Glossory](#Capital-Group-Glossory) 
<br><br>

## Overview
Amazon GuardDuty is a continuous security monitoring service that analyzes and processes the following Data sources: VPC Flow Logs, AWS CloudTrail management event logs, CloudTrail S3 data event logs, and DNS logs. It uses threat intelligence feeds, such as lists of malicious IP addresses and domains, and machine learning to identify unexpected and potentially unauthorized and malicious activity within your AWS environment. This can include issues like escalations of privileges, uses of exposed credentials, or communication with malicious IP addresses, or domains. For example, GuardDuty can detect compromised EC2 instances serving malware or mining bitcoin. It also monitors AWS account access behavior for signs of compromise, such as unauthorized infrastructure deployments, like instances deployed in a Region that has never been used, or unusual API calls, like a password policy change to reduce password strength.

<img src="/docs/img/guardduty/guardduty_example.jpg" width="800"><br>

**NOTE:** <br>
```
GuardDuty is an AWS Managed service offering, the underlying Infrastructure including Network and Compute resources are all managed by AWS as explained in the Shared Responsibility Model. Due to this fact, CG's standard public access controls cannot be applied and the controls to keep the service from external or public accessibility falls on AWS.
```