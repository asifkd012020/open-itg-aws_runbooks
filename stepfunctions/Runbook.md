<img src="https://a0.awsstatic.com/libra-css/images/logos/aws_logo_smile_1200x630.png" alt="AWS" width="250"/>

# Amazon Step Functions - Security Playbook <!-- omit in toc -->
<h1><span style="color:red"> Currently Not Approved for Use!</span></h1>

## NIST Cybersecurity Framework Alignment <!-- omit in toc -->

**Generated By:**  
[Martin Pieters (MTNP)](https://cgweb3/profile/MTNP)
<br>
Security Engineering

**Last Update:** *01/01/2021*
<br><br>
# Overview

Step functions use a descriptive json model to define a state machine (~DAG). At runtime step functions use the state machine to orchestrate between activities and provides conditions, retry, timeout and exception handling logics. 

***Step functions create historical records for previous executions (upto 25,000 latest executions retained for 90 days). The historical executions include the state machine and the runtime state object which includes the inputs and outputs to individual activities.***

As a best practice input and output to activities must not contain any sensitive information (similar to REST API Query parameters, Cloud formation Parameters, Environment variables, etc.). However, if the due-diligence is not in place and sensitive data is included in the input or the output of activities the sensitive data will be stored in the execution history. 

Although step functions use server-side encryption to encrypt the history at rest and use SSL encryption in transit, as of December 2020 they do not support using a CMK for the encryption. Furthermore, AWS does not provide out-of-the-box support for purging the historical data. We have contacted AWS and they have notified us - under NDA - that CMK support is planned for the 2021 year (targeting Q4 release). 

The DaaS team is requesting an exception to allow the DaaS team to use AWS step function in the Prod environment with remedies defined in the Remediation Recommendation section.

This results in [CS0012168 - Strong encryption key management controls are in place for cloud provider services to protect data at rest.](https://capitalgroup.service-now.com/cg_grc?id=cg_grc_action_item_details&sys_id=b6df51521b5a8050da4bdca4bd4bcb48&table=sn_compliance_policy_statement&view=sp) not being met. 


IGTech DaaS has an **exception** for it's use: <br>
https://capitalgroup.service-now.com/cg_grc?id=cg_grc_action_item_details&sys_id=9d3e9134db9928505864ecfc139619a1&table=sn_grc_issue&view=sp