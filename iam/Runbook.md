<img src="https://a0.awsstatic.com/libra-css/images/logos/aws_logo_smile_1200x630.png" alt="AWS" width="250"/>

# AWS IAM - Security Playbook <!-- omit in toc -->
## Capgroup Cybersecurity Control Alignment <!-- omit in toc -->

**Generated By:**  
[Madison Ericksen (MDLE)](https://cgweb3/profile/MDLE)
<br>
Security Engineering

**Last Update:** *09/27/2021*

## Table of Contents <!-- omit in toc -->
- [Overview](#overview)
- [Cloud Security Requirements](#cloud-security-requirements)
  - [1. Local IAM Users may only be operated via the CG network](#1-local-iam-users-may-only-be-operated-via-the-cg-network)
  - [2. Local IAM User provision requests are made through Access Central](#2-local-iam-user-provision-requests-are-made-through-access-central)
  - [3. Local IAM Users are reviewed semi-annually and removed when there is no longer a business need](#3-local-iam-users-are-reviewed-semi-annually-and-removed-when-there-is-no-longer-a-business-need)
  - [4. Local IAM Users are only provisioned AWS Management Console access when enterprise SSO is not available](#4-local-iam-users-are-only-provisioned-aws-management-console-access-when-enterprise-sso-is-not-available)
  - [5. Local IAM Users are given access granting least privilege](#5-local-iam-users-are-given-access-granting-least-privilege)
  - [6. Credentials are stored within an enterprise approved password vaulting tool](#6-credentials-are-stored-within-an-enterprise-approved-password-vaulting-tool)
  - [7. Local IAM Users are operated only by the intended recipient](#7-local-iam-users-are-operated-only-by-the-intended-recipient)
  - [8. Programmatic access keys are handed off according to CG enterprise requirements](#8-programmatic-access-keys-are-handed-off-according-to-cg-enterprise-requirements)
  - [9. Programmatic access keys are rotated every 90 days](#9-programmatic-access-keys-are-rotated-every-90-days)
  - [10. Local IAM Users with console passwords must align to CG Enterprise Password Management standards](#10-local-iam-users-with-console-passwords-must-align-to-cg-enterprise-password-management-standards)
  - [11. Local IAM Users with console passwords must be secured with Multi-Factor Authentication](#11-local-iam-users-with-console-passwords-must-be-secured-with-multi-factor-authentication)
- [Other Operational Expectations](#other-operational-expectations)
  - [1. Operational Item 1](#1-operational-item-1)
  - [2. Operational Item 2](#2-operational-item-2)
  - [3. Operational Item 3](#3-operational-item-3)
- [Endnotes](#endnotes)
- [Capital Group Glossory](#capital-group-glossory)
<br><br>

## Overview
A brief overview of the AWS service being reviewed, including a deployment example diagram as well as features and common uses for the service.
<br><br>

## Cloud Security Requirements

### 1. Local IAM Users may only be operated via the CG network 

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012318](https://capitalgroup.service-now.com/cg_grc?sys_id=534f8d4b1bea6850371277741a4bcbc2&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Direct external connectivity to and from internal CG systems is not permitted. Connectivity to external networks must traverse traffic control devices in the perimeter network zones.|

**Why?** 

Local IAM users are non-federated users, meaning they are not managed by CG's enterprise user system.

**How?** 

An IAM user group allows you to specify permissions for a collection of users. A user group can contain many users and a user can belong to multiple user groups.

During the provisioning process, local IAM users are added to the IAM user group **CGIPRestricted**, which permits access only to source IP's on the CG network.
<br><br>

### 2. Local IAM User provision requests are made through Access Central

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012193](https://capitalgroup.service-now.com/cg_grc?sys_id=ffdf15521b5a8050da4bdca4bd4bcb10&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Generic accounts must be associated with an enterprise defined application/technology ID, purpose recorded, and owned by the application or technology steward. (Statement of Direction)|

**Why?** 

All local user provision requests are made through Access Central to ensure all required information is recorded and necessary approval is given for each local user. This also ensures ownership can be traced to the appropriate team.

**How?** 

To make the provision request, complete the following steps:

1. Navigate to [Access Central](https://accesscentral.capgroup.com/identityiq/home.jsf).
2. Open the hamburger menu in the top left corner, then click the 'Manage Access' dropdown.
3. Select 'Custom Access Request'.
4. Into 'Requestee(s)', enter the ATM ID associated with the AWS account and select the applicable 'Generic Identity for *Application* for *AWS Account Environment*'. 
   - For a list of mappings from AWS Account Environment to AD Group Environment, [click here](https://confluence.capgroup.com/pages/viewpage.action?spaceKey=IAM&title=IAM+End-User+Guide#IAMEndUserGuide-accountmapping).
5. 'Access Requested' must include the following information:
   - Desired name of user (refer to [Cloud Naming Standards](https://confluence.capgroup.com/display/SAA/Cloud+naming+standards))
   - Permissions/policies to attach to user
   - General level of access (Admin/Edit/Read)
6. 'Access Item Description' must include the following information:
   - AWS Account ID
   - ATM ID to associate with user
   - Justification (why you need a local IAM user instead of leveraging an IAM role)
7. For the 'Assignment Group' enter "Sec Eng - Cloud IAM Services".
8. Once submitted, the request will be appropriately reviewed and, once approved, will then be provisioned by the Cloud IAM Services team.
<br><br>

### 3. Local IAM Users are reviewed semi-annually and removed when there is no longer a business need

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012197](https://capitalgroup.service-now.com/cg_grc?sys_id=88ef15521b5a8050da4bdca4bd4bcbc9&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Information system(s) access privileges and roles are reviewed semi-annually; access deemed unnecessary are removed, disabled, or locked.|

**Why?** 

CG's Cloud Security standards require unnecessary access and accounts be disabled or removed in a timely manner. Unused accounts become a burden to maintain and may accrue unexpected costs. Deleting a local user that is no longer needed prevents misuse of an unused, unmonitored user account.

**How?** 

It is the responsibility of the application or product's team which owns the local IAM user to identify when such user is no longer needed. A request for deletion can be made via ServiceNow.
<br><br>

### 4. Local IAM Users are only provisioned AWS Management Console access when enterprise SSO is not available

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012135](https://capitalgroup.service-now.com/cg_grc?sys_id=a9df9d121b5a8050da4bdca4bd4bcb65&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Interactive logons for service accounts must be disabled and restricted. (Statement of Direction)|

**Why?** 

As generic/service accounts, local IAM users should never need console access. It is both CG and AWS IAM best practice to disable unnecessary access credentials to prevent unintentional or malicious misuse.

**How?** 

Upon provisioning, local IAM users are only setup with programmatic access keys. A console password is never created. Individuals should not attempt to enable console access for these accounts. No further steps are required to enforce this standard.


<br><br>


### 5. Local IAM Users are given access granting least privilege

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012181](https://capitalgroup.service-now.com/cg_grc?sys_id=57df91521b5a8050da4bdca4bd4bcb51&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Logical and physical access must be approved based on legitimate business/IT needs, least privilege and segregation of duties requirements.|

**Why?** 

Why

**How?** 

How


<br><br>


### 6. Credentials are stored within an enterprise approved password vaulting tool

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012191](https://capitalgroup.service-now.com/cg_grc?sys_id=ffdfd1521b5a8050da4bdca4bd4bcbb6&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Generic account credentials must be stored within an enterprise approved password vaulting tool. (Statement of Direction)|

**Why?** 

According to current regulatory requirements, all generic/non-identity accounts are required to have their credentials vaulted in CyberArk to protect these accounts from compromise and misuse. Vaulting also allows for API calls to retrieve user credentials, avoiding the need to hardcode access keys into files.

**How?** 

To vault local IAM user access key(s) in CyberArk, complete the following steps:

1. If your team does not already have a CyberArk safe, follow [this guide](https://confluence.capgroup.com/pages/viewpage.action?pageId=90346293) to request one be provisioned.
2. Fill out the details requested in the [CyberArk account onboarding wrapper form](https://confluence.capgroup.com/download/attachments/241115789/CyberArk_AWS_API_End_User_Questionnaire_V2.0.xlsx?version=1&modificationDate=1608672201513&api=v2).
3. Submit an IT Request in ServiceNow:
   1. Navigate to the [Service Request for ITG Use](https://capitalgroup.service-now.com/nav_to.do?uri=%2Fcom.glideapp.servicecatalog_cat_item_view.do%3Fv%3D1%26sysparm_id%3D1162700edbb813408ef07c1ebf9619af%26sysparm_link_parent%3D453087b4db123b008ef07c1ebf9619eb%26sysparm_catalog%3De0d08b13c3330100c8b837659bba8fb4%26sysparm_catalog_view%3Dcatalog_default) form.
   2. Assign this to "Sec Eng - CyberArk Services".
   3. In order for Sec Eng L2 to create the account, the current access key will need to be securely handed off via the [SecEng Secrets Management Portal](https://seceng.capgroup.com/app/secrets).
4. CyberArk L2 Team will validate the request and if everything is provided correctly, send it to Directory Services for policy enablement. In case of missing or incorrect values, team will revert on the same request. 
5. Directory Services team to Enable Policy Settings for AWS IAM Users and confirm to CyberArk L2 team.
6. CyberArk L2 team will proceed with the account onboarding into new safe.
7. Confirm the ServiceNow Ticket and close it.
<br><br>


### 7. Local IAM Users are operated only by the intended recipient

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012192](https://capitalgroup.service-now.com/cg_grc?sys_id=57df91521b5a8050da4bdca4bd4bcb51&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Usage of generic account(s) is authorized and is traceable to an individual or system. (Statement of Direction)|

**Why?** 

Why

**How?** 

How


<br><br>


### 8. Programmatic access keys are handed off according to CG enterprise requirements

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012182](https://capitalgroup.service-now.com/cg_grc?sys_id=9fdf91521b5a8050da4bdca4bd4bcb6a&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Password(s) must be encrypted at rest and in transit in alignment with enterprise requirements.|

**Why?** 

Every time a secret is communicated, there is an opportunity for interception. To reduce the risk of an unintended party obtaining your credentials, access keys are handed off during provisioning using the [SecEng Secrets Management Portal](https://seceng.capgroup.com/app/secrets).

**How?** 

In order to access Secrets Management, you need to have MFA set up through OKTA for your user account. Navigate to http://cgoktaportal.capgroup.com/ to set up your MFA if you haven't done so yet.

**Retrieving the Access Key:**

As the user who made the local IAM user provision request:
1. Navigate to https://seceng.capgroup.com/app/secrets.
2. Click on 'SECRETS RETRIEVAL' on the Secrets Management menu bar.
3. Once in the 'SECRETS RETRIEVAL' section, you will see any secrets shared with you. Click on the secret containing the desired access key to retrieve it.
<br><br>

### 9. Programmatic access keys are rotated every 90 days

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012175](https://capitalgroup.service-now.com/cg_grc?sys_id=4fdf51521b5a8050da4bdca4bd4bcbc8&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Generic account passwords must be changed annually. (Statement of Direction)|

**Why?** 

Rotating access keys regularly is a safeguard against unknowingly compromised access keys. This practice limits how long a compromised key could be used to access your resources. CG follows the recommendation of AWS by requiring IAM user access keys be rotated every 90 days.

**How?** 

AWS allows an IAM user to have 2 access keys at any given time. This is so a new key can be generated and the old key can then be disabled, then deleted. If the old deactivated key is not deleted, no new keys can be generated thus preventing future rotation. 

As local IAM users do not have console access, there are two methods available to rotate AWS programmatic access keys:

- Automatic rotation through CyberArk 

  1. Step 1 https://confluence.capgroup.com/pages/viewpage.action?pageId=241115789
  2. Step 2
   
- Manual rotation via scripts

  1. Step 1
  2. Step 2

<br><br>

### 10. Local IAM Users with console passwords must align to CG Enterprise Password Management standards

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012184](https://capitalgroup.service-now.com/cg_grc?sys_id=97df91521b5a8050da4bdca4bd4bcbcb&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp)|Passwords must meet additional enterprise requirements. (Statement of Direction)|

>**NOTE:**  
>This standard applies only to LAB Accounts. If you do not have a LAB Account, console access will be disabled by default and no such password will exist. 

**Why?** 

Unlike other local IAM users, LAB Accounts are provisioned console access. Passwords for these accounts must conform to CG's additional password standards for generic accounts to adequately protect the additional mode of access.

**How?** 

Console passwords must meet all of the following requirements:

1. Passwords are at least 15 characters in length.
2. Passwords are sufficiently complex.
   -  Must contain all of the following:
      -  At least 1 uppercase letter A-Z
      -  At least 1 lowercase letter a-z
      -  At least 1 number 0-9
      -  At least 1 special character 
                  
              ! @ # $ % ^ & * ( ) _ + - = [ ] { } | '
3. Passwords are not composed of easily guessed words or phrases.
4. Passwords do not match any of the 24 previous passwords.
5. Passwords are rotated every 90 days.
<br><br>

### 11. Local IAM Users with console passwords must be secured with Multi-Factor Authentication

**Capital Group Controls:** 
|Control Statement|Description|
|------|----------------------|
|[CS0012180]((https://capitalgroup.service-now.com/cg_grc?sys_id=4fdf91521b5a8050da4bdca4bd4bcb44&table=sn_compliance_policy_statement&id=cg_grc_action_item_details&view=sp))|All cloud-based user accounts are secured with authentication mechanisms that are commensurate to the risk(s) identified.
|

>**NOTE:**  
>This standard applies only to LAB Accounts. If you do not have a LAB Account, console access will be disabled by default and standard MFA methods will not be applicable.

**Why?** 

Multi-Factor Authentication (MFA) provides an additional layer of security against unauthorized access to your account, services, and resources. Because AWS does not have a lockout function for repeated login attempts, AWS recommends requiring MFA to bridge the gap in security. MFA typically requires a user to login with their usual credentials then provide a code sent to or generated by a trusted mobile device.

**How?** 

How this requirement should be met, and how an engineer build to adhere to the requirement.
<br><br>

## Other Operational Expectations

### 1. Operational Item 1

**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|Control statement not always needed|Control definition description if needed|

**What, Why & How?**

Brief overview of what the operational item is, why CG needs it and how to find further information related to service owner, internal documentation and contacts.

[Link 1 to Internal Documentation for further reading.](https://link1)<br>
[Link 2 to Internal Documentation for further reading.](https://link2)<br>
[Link 3 to Internal Documentation for further reading.](https://link3)
<br><br>

### 2. Operational Item 2

**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|Control statement not always needed|Control definition description if needed|

**What, Why & How?**

Brief overview of what the operational item is, why CG needs it and how to find further information related to service owner, internal documentation and contacts.

[Link 1 to Internal Documentation for further reading.](https://link1)<br>
[Link 2 to Internal Documentation for further reading.](https://link2)<br>
[Link 3 to Internal Documentation for further reading.](https://link3)
<br><br>

### 3. Operational Item 3

**Capital Group:** <br>

|Control Statement|Description|
|------|----------------------|
|Control statement not always needed|Control definition description if needed|

**What, Why & How?**

Brief overview of what the operational item is, why CG needs it and how to find further information related to service owner, internal documentation and contacts.

[Link 1 to Internal Documentation for further reading.](https://link1)<br>
[Link 2 to Internal Documentation for further reading.](https://link2)<br>
[Link 3 to Internal Documentation for further reading.](https://link3)
<br><br>

## Endnotes
**Resources**<br>
1. https://link1
2. https://link2
3. https://link3

## Capital Group Glossory 
**Data** - Digital pieces of information stored or transmitted for use with an information system from which understandable information is derived. Items that could be considered to be data are: Source code, meta-data, build artifacts, information input and output.  
 
**Information System** - An organized assembly of resources and procedures for the collection, processing, maintenance, use, sharing, dissemination, or disposition of information. All systems, platforms, compute instances including and not limited to physical and virtual client endpoints, physical and virtual servers, software containers, databases, Internet of Things (IoT) devices, network devices, applications (internal and external), Serverless computing instances (i.e. AWS Lambda), vendor provided appliances, and third-party platforms, connected to the Capital Group network or used by Capital Group users or customers.

**Log** - a record of the events occurring within information systems and networks. Logs are composed of log entries; each entry contains information related to a specific event that has occurred within a system or network.

**Information** - communication or representation of knowledge such as facts, data, or opinions in any medium or form, including textual, numerical, graphic, cartographic, narrative, or audiovisual. 

**Cloud computing** - A model for enabling ubiquitous, convenient, on-demand network access to a shared pool of configurable computing resources (e.g., networks, servers, storage, applications, and services) that can be rapidly provisioned and released with minimal management effort or service provider interaction.

**Vulnerability**  - Weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source. Note: The term weakness is synonymous for deficiency. Weakness may result in security and/or privacy risks.
